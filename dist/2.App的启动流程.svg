<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="938px" preserveAspectRatio="none" style="width:1243px;height:938px;" version="1.1" viewBox="0 0 1243 938" width="1243px" zoomAndPan="magnify"><defs><filter height="300%" id="fqwjydoo9mb4u" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="136" x="554.75" y="28.6855">2.App的启动过程</text><rect fill="#FFFFFF" filter="url(#fqwjydoo9mb4u)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="175" y="121.6016"/><rect fill="#FFFFFF" filter="url(#fqwjydoo9mb4u)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="374" y="151.9531"/><rect fill="#FFFFFF" filter="url(#fqwjydoo9mb4u)" height="48.5273" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="477" y="220.6563"/><rect fill="#FFFFFF" filter="url(#fqwjydoo9mb4u)" height="179.7578" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="682" y="682.5781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="80" x2="80" y1="89.25" y2="880.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="179.5" x2="179.5" y1="89.25" y2="880.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="378.5" x2="378.5" y1="89.25" y2="880.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="481.5" x2="481.5" y1="89.25" y2="880.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="687" x2="687" y1="89.25" y2="880.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="842" x2="842" y1="89.25" y2="880.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1217.5" x2="1217.5" y1="89.25" y2="880.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="47" y="86.1738">Launcher</text><ellipse cx="80" cy="55.6406" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="68" x2="92" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="47" y="893.8691">Launcher</text><ellipse cx="80" cy="912.9453" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="68" x2="92" y1="926.9453" y2="926.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="162.5" y="86.1738">AMS</text><ellipse cx="180" cy="55.6406" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="168" x2="192" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="162.5" y="893.8691">AMS</text><ellipse cx="180" cy="912.9453" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="168" x2="192" y1="926.9453" y2="926.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="354.5" y="86.1738">Zygote</text><ellipse cx="379" cy="55.6406" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="367" x2="391" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="354.5" y="893.8691">Zygote</text><ellipse cx="379" cy="912.9453" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="367" x2="391" y1="926.9453" y2="926.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="452.5" y="86.1738">App进程</text><ellipse cx="482" cy="55.6406" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="470" x2="494" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="452.5" y="893.8691">App进程</text><ellipse cx="482" cy="912.9453" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="470" x2="494" y1="926.9453" y2="926.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="662" y="86.1738">Activity</text><ellipse cx="687" cy="55.6406" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="675" x2="699" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="662" y="893.8691">Activity</text><ellipse cx="687" cy="912.9453" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="675" x2="699" y1="926.9453" y2="926.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="797" y="86.1738">ViewRootImpl</text><ellipse cx="842" cy="55.6406" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="830" x2="854" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="84" x="797" y="893.8691">ViewRootImpl</text><ellipse cx="842" cy="912.9453" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="830" x2="854" y1="926.9453" y2="926.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="1198.5" y="86.1738">WMS</text><ellipse cx="1218" cy="55.6406" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1206" x2="1230" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="1198.5" y="893.8691">WMS</text><ellipse cx="1218" cy="912.9453" fill="#FEFECE" filter="url(#fqwjydoo9mb4u)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="1206" x2="1230" y1="926.9453" y2="926.9453"/><rect fill="#FFFFFF" filter="url(#fqwjydoo9mb4u)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="175" y="121.6016"/><rect fill="#FFFFFF" filter="url(#fqwjydoo9mb4u)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="374" y="151.9531"/><rect fill="#FFFFFF" filter="url(#fqwjydoo9mb4u)" height="48.5273" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="477" y="220.6563"/><rect fill="#FFFFFF" filter="url(#fqwjydoo9mb4u)" height="179.7578" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="682" y="682.5781"/><polygon fill="#A80036" points="163,117.6016,173,121.6016,163,125.6016,167,121.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="80" x2="169" y1="121.6016" y2="121.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="87" y="116.7451">startActivity()</text><polygon fill="#A80036" points="362,147.9531,372,151.9531,362,155.9531,366,151.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="180" x2="368" y1="151.9531" y2="151.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="187" y="147.0967">socket通信:请求创建App进程</text><polygon fill="#A80036" points="470,178.3047,480,182.3047,470,186.3047,474,182.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379" x2="476" y1="182.3047" y2="182.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="386" y="177.4482">fork App进程</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="529" y1="207.6563" y2="207.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="529" x2="529" y1="207.6563" y2="220.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="488" x2="529" y1="220.6563" y2="220.6563"/><polygon fill="#A80036" points="498,216.6563,488,220.6563,498,224.6563,494,220.6563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="494" y="202.7998">ActivityThread.main()</text><path d="M397,196.8047 L397,222.8047 L468,222.8047 L468,206.8047 L458,196.8047 L397,196.8047 " fill="#FBFB77" filter="url(#fqwjydoo9mb4u)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M458,196.8047 L458,206.8047 L468,206.8047 L458,196.8047 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="403" y="215.2998">开启loop</text><polygon fill="#A80036" points="191,265.1836,181,269.1836,191,273.1836,187,269.1836" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="185" x2="481" y1="269.1836" y2="269.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="197" y="264.3271">attachApplication(appThread)</text><path d="M8,238.6563 L8,280.6563 L171,280.6563 L171,248.6563 L161,238.6563 L8,238.6563 " fill="#CCFFE5" filter="url(#fqwjydoo9mb4u)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M161,238.6563 L161,248.6563 L171,248.6563 L161,238.6563 " fill="#CCFFE5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="14" y="257.1514">注册ApplicationThread，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="14" y="273.5029">可以和AMS双向通信。</text><polygon fill="#A80036" points="470,308.7109,480,312.7109,470,316.7109,474,312.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="180" x2="476" y1="312.7109" y2="312.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="187" y="307.8545">thread.bindApplication();</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="524" y1="343.0625" y2="343.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="524" x2="524" y1="343.0625" y2="356.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="483" x2="524" y1="356.0625" y2="356.0625"/><polygon fill="#A80036" points="493,352.0625,483,356.0625,493,360.0625,489,356.0625" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="489" y="338.2061">(Application)clazz.newInstance();</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="524" y1="393.0898" y2="393.0898"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="524" x2="524" y1="393.0898" y2="406.0898"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="483" x2="524" y1="406.0898" y2="406.0898"/><polygon fill="#A80036" points="493,402.0898,483,406.0898,493,410.0898,489,406.0898" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="489" y="388.2334">app.attach(context);</text><path d="M330,369.0625 L330,411.0625 L473,411.0625 L473,379.0625 L463,369.0625 L330,369.0625 " fill="#FBFB77" filter="url(#fqwjydoo9mb4u)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M463,369.0625 L463,379.0625 L473,379.0625 L463,369.0625 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="336" y="387.5576">1.attachBaseContext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="336" y="403.9092">2.取出mLoadedApk</text><polygon fill="#A80036" points="470,439.1172,480,443.1172,470,447.1172,474,443.1172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="180" x2="476" y1="443.1172" y2="443.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="187" y="438.2607">thread.scheduleLaunchActivity()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="524" y1="473.4688" y2="473.4688"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="524" x2="524" y1="473.4688" y2="486.4688"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="483" x2="524" y1="486.4688" y2="486.4688"/><polygon fill="#A80036" points="493,482.4688,483,486.4688,493,490.4688,489,486.4688" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="489" y="468.6123">(Activity)clazz.newInstance();</text><polygon fill="#A80036" points="675,525.9961,685,529.9961,675,533.9961,679,529.9961" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="681" y1="529.9961" y2="529.9961"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="489" y="525.1396">attach(context, ..., application,)</text><path d="M330,499.4688 L330,541.4688 L473,541.4688 L473,509.4688 L463,499.4688 L330,499.4688 " fill="#FBFB77" filter="url(#fqwjydoo9mb4u)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M463,499.4688 L463,509.4688 L473,509.4688 L463,499.4688 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="336" y="517.9639">1.attachBaseContext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="336" y="534.3154">2.初始化Window</text><polygon fill="#A80036" points="675,574.5234,685,578.5234,675,582.5234,679,578.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="681" y1="578.5234" y2="578.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="489" y="573.667">onCreate()</text><path d="M345,556.1719 L345,582.1719 L473,582.1719 L473,566.1719 L463,556.1719 L345,556.1719 " fill="#FBFB77" filter="url(#fqwjydoo9mb4u)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M463,556.1719 L463,566.1719 L473,566.1719 L463,556.1719 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="351" y="574.667">1.installDecorView</text><polygon fill="#A80036" points="675,609.875,685,613.875,675,617.875,679,613.875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="681" y1="613.875" y2="613.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="489" y="609.0186">onResume()</text><polygon fill="#A80036" points="675,640.2266,685,644.2266,675,648.2266,679,644.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="681" y1="644.2266" y2="644.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="489" y="639.3701">makeVisible()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="687" x2="734" y1="669.5781" y2="669.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="734" x2="734" y1="669.5781" y2="682.5781"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="693" x2="734" y1="682.5781" y2="682.5781"/><polygon fill="#A80036" points="703,678.5781,693,682.5781,703,686.5781,699,682.5781" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="699" y="664.7217">wm.addView(decorView)</text><polygon fill="#A80036" points="830,713.9297,840,717.9297,830,721.9297,834,717.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="692" x2="836" y1="717.9297" y2="717.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="699" y="713.0732">new ViewRootImpl()</text><polygon fill="#A80036" points="830,744.2813,840,748.2813,830,752.2813,834,748.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="692" x2="836" y1="748.2813" y2="748.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="114" x="699" y="743.4248">setView(decorView)</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="842" x2="884" y1="778.6328" y2="778.6328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="884" x2="884" y1="778.6328" y2="791.6328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="843" x2="884" y1="791.6328" y2="791.6328"/><polygon fill="#A80036" points="853,787.6328,843,791.6328,853,795.6328,849,791.6328" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="849" y="773.7764">scheduleTraversals()</text><path d="M710,762.7813 L710,788.7813 L833,788.7813 L833,772.7813 L823,762.7813 L710,762.7813 " fill="#FBFB77" filter="url(#fqwjydoo9mb4u)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M823,762.7813 L823,772.7813 L833,772.7813 L823,762.7813 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="102" x="716" y="781.2764">1.注册VSync信号</text><polygon fill="#A80036" points="1206,831.1602,1216,835.1602,1206,839.1602,1210,835.1602" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="842" x2="1212" y1="835.1602" y2="835.1602"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="352" x="849" y="830.3037">IWindowSession#addToDisplay(mWindow, ...mInputChannel)</text><path d="M636,804.6328 L636,846.6328 L833,846.6328 L833,814.6328 L823,804.6328 L636,804.6328 " fill="#CCFFE5" filter="url(#fqwjydoo9mb4u)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M823,804.6328 L823,814.6328 L833,814.6328 L823,804.6328 " fill="#CCFFE5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="642" y="823.1279">注册IWindow，InputChannel，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="642" y="839.4795">可以和WMS双向通信。</text><polygon fill="#A80036" points="698,858.3359,688,862.3359,698,866.3359,694,862.3359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="692" x2="841" y1="862.3359" y2="862.3359"/><!--MD5=[04de6a019071c0442b214e781f2cca91]
@startuml


title __2.App的启动过程__

entity "Launcher"
entity AMS
entity Zygote

entity "App进程" as App
entity Activity
entity ViewRootImpl
entity WMS


Launcher -> AMS: startActivity()
activate AMS
    AMS -> Zygote: socket通信:请求创建App进程
deactivate AMS

activate Zygote
    Zygote -> App: fork App进程
deactivate Zygote


App -> App: ActivityThread.main()
note left :开启loop
activate App
    App->  AMS: attachApplication(appThread)
    note left#ccffe5 : 注册ApplicationThread，\n可以和AMS双向通信。
deactivate App

AMS -> App: thread.bindApplication();
App -> App: (Application)clazz.newInstance();
App -> App: app.attach(context);
note left :1.attachBaseContext\n2.取出mLoadedApk

AMS -> App: thread.scheduleLaunchActivity()
App -> App: (Activity)clazz.newInstance();
App -> Activity:  attach(context, ..., application,)
note left :1.attachBaseContext\n2.初始化Window

App -> Activity:  onCreate()
note left :1.installDecorView

App -> Activity:  onResume()
App -> Activity:  makeVisible()
Activity -> Activity:  wm.addView(decorView)
activate Activity
    Activity -> ViewRootImpl: new ViewRootImpl()
    Activity -> ViewRootImpl: setView(decorView)

    ViewRootImpl -> ViewRootImpl: scheduleTraversals()
    note left :1.注册VSync信号

    ViewRootImpl -> WMS: IWindowSession#addToDisplay(mWindow, ...mInputChannel)
    note left#ccffe5 : 注册IWindow，InputChannel，\n可以和WMS双向通信。
    ViewRootImpl - -> Activity
deactivate Activity







@enduml

PlantUML version 1.2020.06(Sun Apr 05 20:38:32 CST 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_131-b11
Operating System: Windows 10
Default Encoding: UTF8
Language: zh
Country: CN
--></g></svg>