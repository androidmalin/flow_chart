<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="950px" preserveAspectRatio="none" style="width:777px;height:950px;" version="1.1" viewBox="0 0 777 950" width="777px" zoomAndPan="magnify"><defs><filter height="300%" id="f1dxl2paiohadw" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="136" x="321.5" y="28.6855">2.App的启动过程</text><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="175" y="121.6016"/><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="374" y="151.9531"/><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="48.5273" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="477" y="264.0078"/><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="287.9883" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="477" y="573.1719"/><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="127.4063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="482" y="611.5234"/><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="78.8789" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="482" y="782.2813"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="80" x2="80" y1="89.25" y2="892.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="179.5" x2="179.5" y1="89.25" y2="892.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="378.5" x2="378.5" y1="89.25" y2="892.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="481.5" x2="481.5" y1="89.25" y2="892.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="697" x2="697" y1="89.25" y2="892.3359"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="751" x2="751" y1="89.25" y2="892.3359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="47" y="86.1738">Launcher</text><ellipse cx="80" cy="55.6406" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="68" x2="92" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="60" x="47" y="905.8691">Launcher</text><ellipse cx="80" cy="924.9453" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="68" x2="92" y1="938.9453" y2="938.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="162.5" y="86.1738">AMS</text><ellipse cx="180" cy="55.6406" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="168" x2="192" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="162.5" y="905.8691">AMS</text><ellipse cx="180" cy="924.9453" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="168" x2="192" y1="938.9453" y2="938.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="354.5" y="86.1738">Zygote</text><ellipse cx="379" cy="55.6406" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="367" x2="391" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="354.5" y="905.8691">Zygote</text><ellipse cx="379" cy="924.9453" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="367" x2="391" y1="938.9453" y2="938.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="452.5" y="86.1738">App进程</text><ellipse cx="482" cy="55.6406" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="470" x2="494" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="452.5" y="905.8691">App进程</text><ellipse cx="482" cy="924.9453" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="470" x2="494" y1="938.9453" y2="938.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="672" y="86.1738">Activity</text><ellipse cx="697" cy="55.6406" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="685" x2="709" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="672" y="905.8691">Activity</text><ellipse cx="697" cy="924.9453" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="685" x2="709" y1="938.9453" y2="938.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="732" y="86.1738">WMS</text><ellipse cx="751.5" cy="55.6406" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="739.5" x2="763.5" y1="69.6406" y2="69.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="33" x="732" y="905.8691">WMS</text><ellipse cx="751.5" cy="924.9453" fill="#FEFECE" filter="url(#f1dxl2paiohadw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="739.5" x2="763.5" y1="938.9453" y2="938.9453"/><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="175" y="121.6016"/><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="30.3516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="374" y="151.9531"/><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="48.5273" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="477" y="264.0078"/><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="287.9883" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="477" y="573.1719"/><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="127.4063" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="482" y="611.5234"/><rect fill="#FFFFFF" filter="url(#f1dxl2paiohadw)" height="78.8789" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="482" y="782.2813"/><polygon fill="#A80036" points="163,117.6016,173,121.6016,163,125.6016,167,121.6016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="80" x2="169" y1="121.6016" y2="121.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="87" y="116.7451">startActivity()</text><polygon fill="#A80036" points="362,147.9531,372,151.9531,362,155.9531,366,151.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="180" x2="368" y1="151.9531" y2="151.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="187" y="147.0967">socket通信:请求创建App进程</text><polygon fill="#A80036" points="470,178.3047,480,182.3047,470,186.3047,474,182.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="379" x2="476" y1="182.3047" y2="182.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="386" y="177.4482">fork App进程</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="524" y1="212.6563" y2="212.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="524" x2="524" y1="212.6563" y2="225.6563"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="483" x2="524" y1="225.6563" y2="225.6563"/><polygon fill="#A80036" points="493,221.6563,483,225.6563,493,229.6563,489,225.6563" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="489" y="207.7998">AppRuntime#onZygoteInit()</text><path d="M365,196.8047 L365,222.8047 L473,222.8047 L473,206.8047 L463,196.8047 L365,196.8047 " fill="#FBFB77" filter="url(#f1dxl2paiohadw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M463,196.8047 L463,206.8047 L473,206.8047 L463,196.8047 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="371" y="215.2998">开启binder机制</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="529" y1="251.0078" y2="251.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="529" x2="529" y1="251.0078" y2="264.0078"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="488" x2="529" y1="264.0078" y2="264.0078"/><polygon fill="#A80036" points="498,260.0078,488,264.0078,498,268.0078,494,264.0078" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="494" y="246.1514">ActivityThread.main()</text><path d="M397,240.1563 L397,266.1563 L468,266.1563 L468,250.1563 L458,240.1563 L397,240.1563 " fill="#FBFB77" filter="url(#f1dxl2paiohadw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M458,240.1563 L458,250.1563 L468,250.1563 L458,240.1563 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="403" y="258.6514">开启loop</text><polygon fill="#A80036" points="191,308.5352,181,312.5352,191,316.5352,187,312.5352" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="185" x2="481" y1="312.5352" y2="312.5352"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="197" y="307.6787">attachApplication(appThread)</text><path d="M8,282.0078 L8,324.0078 L171,324.0078 L171,292.0078 L161,282.0078 L8,282.0078 " fill="#CCFFE5" filter="url(#f1dxl2paiohadw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M161,282.0078 L161,292.0078 L171,292.0078 L161,282.0078 " fill="#CCFFE5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="14" y="300.5029">注册ApplicationThread，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="14" y="316.8545">可以和AMS双向通信。</text><polygon fill="#A80036" points="470,352.0625,480,356.0625,470,360.0625,474,356.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="180" x2="476" y1="356.0625" y2="356.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="187" y="351.2061">thread.bindApplication();</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="524" y1="386.4141" y2="386.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="524" x2="524" y1="386.4141" y2="399.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="483" x2="524" y1="399.4141" y2="399.4141"/><polygon fill="#A80036" points="493,395.4141,483,399.4141,493,403.4141,489,399.4141" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="489" y="381.5576">(Application)clazz.newInstance();</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="524" y1="436.4414" y2="436.4414"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="524" x2="524" y1="436.4414" y2="449.4414"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="483" x2="524" y1="449.4414" y2="449.4414"/><polygon fill="#A80036" points="493,445.4414,483,449.4414,493,453.4414,489,449.4414" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="116" x="489" y="431.585">app.attach(context);</text><path d="M330,412.4141 L330,454.4141 L473,454.4141 L473,422.4141 L463,412.4141 L330,412.4141 " fill="#FBFB77" filter="url(#f1dxl2paiohadw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M463,412.4141 L463,422.4141 L473,422.4141 L463,412.4141 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="336" y="430.9092">1.attachBaseContext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="336" y="447.2607">2.取出mLoadedApk</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="524" y1="486.4688" y2="486.4688"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="524" x2="524" y1="486.4688" y2="499.4688"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="483" x2="524" y1="499.4688" y2="499.4688"/><polygon fill="#A80036" points="493,495.4688,483,499.4688,493,503.4688,489,499.4688" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="489" y="481.6123">installContentProviders();</text><path d="M259,470.6172 L259,496.6172 L473,496.6172 L473,480.6172 L463,470.6172 L259,470.6172 " fill="#FBFB77" filter="url(#f1dxl2paiohadw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M463,470.6172 L463,480.6172 L473,480.6172 L463,470.6172 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="265" y="489.1123">1.一些第三方库会在这里做初始化</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="524" y1="529.8203" y2="529.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="524" x2="524" y1="529.8203" y2="542.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="483" x2="524" y1="542.8203" y2="542.8203"/><polygon fill="#A80036" points="493,538.8203,483,542.8203,493,546.8203,489,542.8203" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="489" y="524.9639">app.onCreate();</text><polygon fill="#A80036" points="465,569.1719,475,573.1719,465,577.1719,469,573.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="180" x2="471" y1="573.1719" y2="573.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="187" y="568.3154">thread.scheduleTransaction()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="487" x2="534" y1="598.5234" y2="598.5234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="534" x2="534" y1="598.5234" y2="611.5234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="493" x2="534" y1="611.5234" y2="611.5234"/><polygon fill="#A80036" points="503,607.5234,493,611.5234,503,615.5234,499,611.5234" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="499" y="593.667">handleLaunchActivity()</text><polygon fill="#A80036" points="685,642.875,695,646.875,685,650.875,689,646.875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="492" x2="691" y1="646.875" y2="646.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="499" y="642.0186">(Activity)clazz.newInstance();</text><polygon fill="#A80036" points="685,686.4023,695,690.4023,685,694.4023,689,690.4023" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="492" x2="691" y1="690.4023" y2="690.4023"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="499" y="685.5459">attach(context, ..., application,)</text><path d="M325,659.875 L325,701.875 L468,701.875 L468,669.875 L458,659.875 L325,659.875 " fill="#FBFB77" filter="url(#f1dxl2paiohadw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M458,659.875 L458,669.875 L468,669.875 L458,659.875 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="331" y="678.3701">1.attachBaseContext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="331" y="694.7217">2.初始化Window</text><polygon fill="#A80036" points="685,734.9297,695,738.9297,685,742.9297,689,738.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="487" x2="691" y1="738.9297" y2="738.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="494" y="734.0732">onCreate()</text><path d="M340,716.5781 L340,742.5781 L468,742.5781 L468,726.5781 L458,716.5781 L340,716.5781 " fill="#FBFB77" filter="url(#f1dxl2paiohadw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M458,716.5781 L458,726.5781 L468,726.5781 L458,716.5781 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="346" y="735.0732">1.installDecorView</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="487" x2="534" y1="769.2813" y2="769.2813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="534" x2="534" y1="769.2813" y2="782.2813"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="493" x2="534" y1="782.2813" y2="782.2813"/><polygon fill="#A80036" points="503,778.2813,493,782.2813,503,786.2813,499,782.2813" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="499" y="764.4248">handleResumeActivity()</text><polygon fill="#A80036" points="685,813.6328,695,817.6328,685,821.6328,689,817.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="492" x2="691" y1="817.6328" y2="817.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="499" y="812.7764">onResume()</text><polygon fill="#A80036" points="739.5,857.1602,749.5,861.1602,739.5,865.1602,743.5,861.1602" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="482" x2="745.5" y1="861.1602" y2="861.1602"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="489" y="856.3037">wm.addView(decorView)</text><path d="M271,830.6328 L271,872.6328 L468,872.6328 L468,840.6328 L458,830.6328 L271,830.6328 " fill="#CCFFE5" filter="url(#f1dxl2paiohadw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M458,830.6328 L458,840.6328 L468,840.6328 L458,830.6328 " fill="#CCFFE5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="277" y="849.1279">注册IWindow，InputChannel，</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="277" y="865.4795">可以和WMS双向通信。</text><!--MD5=[be6daa6ccbf5d7357b789a9c9c23a3df]
@startuml


title __2.App的启动过程__

entity "Launcher"
entity AMS
entity Zygote

entity "App进程" as App
entity Activity
entity WMS


Launcher -> AMS: startActivity()
activate AMS
    AMS -> Zygote: socket通信:请求创建App进程
deactivate AMS

activate Zygote
    Zygote -> App: fork App进程
deactivate Zygote

App -> App: AppRuntime#onZygoteInit()
note left :开启binder机制

App -> App: ActivityThread.main()
note left :开启loop
activate App
    App->  AMS: attachApplication(appThread)
    note left#ccffe5 : 注册ApplicationThread，\n可以和AMS双向通信。
deactivate App

AMS -> App: thread.bindApplication();
App -> App: (Application)clazz.newInstance();
App -> App: app.attach(context);
note left :1.attachBaseContext\n2.取出mLoadedApk
App -> App: installContentProviders();
note left :1.一些第三方库会在这里做初始化
App -> App: app.onCreate();

AMS -> App: thread.scheduleTransaction()
activate App
    App -> App:handleLaunchActivity()
    activate App
        App -> Activity: (Activity)clazz.newInstance();
        App -> Activity:  attach(context, ..., application,)
        note left :1.attachBaseContext\n2.初始化Window

        App -> Activity:  onCreate()
        note left :1.installDecorView
    deactivate App

    App -> App:handleResumeActivity()
    activate App
        App -> Activity:  onResume()
        App -> WMS:  wm.addView(decorView)
        note left#ccffe5 : 注册IWindow，InputChannel，\n可以和WMS双向通信。
    deactivate App
deactivate App


@enduml

PlantUML version 1.2020.06(Sun Apr 05 20:38:32 CST 2020)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_131-b11
Operating System: Windows 10
Default Encoding: UTF8
Language: zh
Country: CN
--></g></svg>